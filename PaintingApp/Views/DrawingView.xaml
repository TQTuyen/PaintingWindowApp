<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="PaintingApp.Views.DrawingView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewmodels="using:PaintingApp.ViewModels"
    xmlns:controls="using:PaintingApp.Controls"
    xmlns:models="using:PaintingApp.Models"
    xmlns:local="using:PaintingApp.Views"
    mc:Ignorable="d"
    Background="Transparent">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- Toolbar with Acrylic Background -->
        <Grid Grid.Row="0"
              Grid.ColumnSpan="2"
              Background="{ThemeResource AcrylicInAppFillColorDefaultBrush}"
              BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
              BorderThickness="0,0,0,1"
              Padding="12,8">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Tool Selector with Dropdown -->
            <StackPanel Grid.Column="0"
                        Orientation="Horizontal"
                        Spacing="8">

                <DropDownButton x:Name="ToolDropDown"
                                MinWidth="140">
                    <DropDownButton.Content>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon x:Name="CurrentToolIcon"
                                      Glyph="&#xE7C9;"
                                      FontSize="16"/>
                            <TextBlock x:Name="CurrentToolText"
                                       Text="{x:Bind ViewModel.SelectedTool, Mode=OneWay}"/>
                        </StackPanel>
                    </DropDownButton.Content>

                    <DropDownButton.Flyout>
                        <MenuFlyout Placement="Bottom">
                            <MenuFlyoutItem Text="Select"
                                            Command="{x:Bind ViewModel.SelectToolCommand}"
                                            CommandParameter="Select"
                                            Click="ToolMenuItem_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE7C9;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutSeparator/>

                            <MenuFlyoutItem Text="Line"
                                            Command="{x:Bind ViewModel.SelectToolCommand}"
                                            CommandParameter="Line"
                                            Click="ToolMenuItem_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE76D;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem Text="Rectangle"
                                            Command="{x:Bind ViewModel.SelectToolCommand}"
                                            CommandParameter="Rectangle"
                                            Click="ToolMenuItem_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE739;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem Text="Circle"
                                            Command="{x:Bind ViewModel.SelectToolCommand}"
                                            CommandParameter="Circle"
                                            Click="ToolMenuItem_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xEA3A;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem Text="Oval"
                                            Command="{x:Bind ViewModel.SelectToolCommand}"
                                            CommandParameter="Oval"
                                            Click="ToolMenuItem_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xF138;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutSeparator/>

                            <MenuFlyoutItem Text="Triangle"
                                            Command="{x:Bind ViewModel.SelectToolCommand}"
                                            CommandParameter="Triangle"
                                            Click="ToolMenuItem_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE879;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>

                            <MenuFlyoutItem Text="Polygon"
                                            Command="{x:Bind ViewModel.SelectToolCommand}"
                                            CommandParameter="Polygon"
                                            Click="ToolMenuItem_Click">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xF408;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                        </MenuFlyout>
                    </DropDownButton.Flyout>
                </DropDownButton>
            </StackPanel>

            <!-- Board Actions -->
            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        Spacing="8"
                        Margin="16,0,0,0">

                <Border Width="1"
                        Height="24"
                        Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>

                <Button Command="{x:Bind ViewModel.NewBoardCommand}"
                        ToolTipService.ToolTip="New Board (Ctrl+N)">
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <FontIcon Glyph="&#xE710;" FontSize="16"/>
                        <TextBlock Text="New"/>
                    </StackPanel>
                </Button>

                <Button Command="{x:Bind ViewModel.SaveBoardCommand}"
                        Style="{StaticResource AccentButtonStyle}"
                        ToolTipService.ToolTip="Save Board (Ctrl+S)">
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <FontIcon Glyph="&#xE74E;" FontSize="16"/>
                        <TextBlock Text="Save"/>
                    </StackPanel>
                </Button>

                <Button Command="{x:Bind ViewModel.DeleteBoardCommand}"
                        ToolTipService.ToolTip="Delete Board">
                    <Button.Resources>
                        <SolidColorBrush x:Key="ButtonForegroundPointerOver" Color="{ThemeResource SystemFillColorCritical}"/>
                    </Button.Resources>
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <FontIcon Glyph="&#xE74D;" FontSize="16"/>
                        <TextBlock Text="Delete"/>
                    </StackPanel>
                </Button>

                <Border Width="1"
                        Height="24"
                        Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>
            </StackPanel>

            <!-- Board Name Display -->
            <StackPanel Grid.Column="2"
                        Orientation="Horizontal"
                        Spacing="8"
                        Margin="8,0,0,0"
                        VerticalAlignment="Center">
                <TextBlock Text="{x:Bind ViewModel.BoardName, Mode=OneWay}"
                           Style="{StaticResource BodyStrongTextBlockStyle}"/>
                <FontIcon Glyph="&#xE7BA;"
                          FontSize="12"
                          Foreground="{ThemeResource SystemFillColorCautionBrush}"
                          Visibility="{x:Bind ViewModel.HasUnsavedChanges, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                          ToolTipService.ToolTip="Unsaved changes"/>
            </StackPanel>

            <!-- Stroke and Fill Settings -->
            <StackPanel Grid.Column="3"
                        Orientation="Horizontal"
                        Spacing="12">

                <!-- Stroke Thickness with Slider + NumberBox -->
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <Slider x:Name="ThicknessSlider"
                            Value="{x:Bind ViewModel.StrokeThickness, Mode=TwoWay}"
                            Minimum="0.5"
                            Maximum="20"
                            StepFrequency="0.5"
                            Width="80"
                            VerticalAlignment="Center"
                            ToolTipService.ToolTip="Stroke Thickness"/>
                    
                    <NumberBox Value="{x:Bind ViewModel.StrokeThickness, Mode=TwoWay}"
                               Minimum="0.5"
                               Maximum="50"
                               SmallChange="0.5"
                               SpinButtonPlacementMode="Compact"
                               Width="70"
                               Height="40"/>
                </StackPanel>

                <!-- Stroke Dash Style Selector -->
                <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                    <ComboBox ItemsSource="{x:Bind ViewModel.AvailableDashStyles, Mode=OneWay}"
                              SelectedItem="{x:Bind ViewModel.SelectedStrokeDashStyle, Mode=TwoWay}"
                              MinWidth="110"
                              ToolTipService.ToolTip="Stroke Dash Style">
                        <ComboBox.ItemTemplate>
                            <DataTemplate x:DataType="models:StrokeDashStyle">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <Canvas Width="40" Height="16" VerticalAlignment="Center">
                                        <Line X1="0" Y1="8" X2="40" Y2="8"
                                              Stroke="{ThemeResource TextFillColorPrimaryBrush}"
                                              StrokeThickness="2"
                                              StrokeDashArray="{x:Bind local:DrawingView.GetDashArrayPreview((models:StrokeDashStyle))}"/>
                                    </Canvas>
                                    <TextBlock Text="{x:Bind}" VerticalAlignment="Center"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>

                <!-- Stroke Color with Presets -->
                <Button x:Name="StrokeColorButton"
                        Width="100"
                        ToolTipService.ToolTip="Stroke Color">
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <Border Width="20"
                                Height="20"
                                Background="{x:Bind ViewModel.StrokeColor, Mode=OneWay, Converter={StaticResource ColorToBrushConverter}}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="2"/>
                        <TextBlock Text="Stroke"
                                   VerticalAlignment="Center"
                                   Style="{StaticResource CaptionTextBlockStyle}"/>
                        <FontIcon Glyph="&#xE70D;" FontSize="10"/>
                    </StackPanel>
                    
                    <Button.Flyout>
                        <Flyout>
                            <StackPanel Spacing="12" Width="300">
                                <TextBlock Text="Stroke Color"
                                           Style="{StaticResource BodyStrongTextBlockStyle}"/>
                                
                                <!-- Color Presets -->
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Quick Colors"
                                               Style="{StaticResource CaptionTextBlockStyle}"/>
                                    <GridView SelectionMode="None"
                                              IsItemClickEnabled="True"
                                              ItemClick="StrokePresetColor_Click">
                                        <GridView.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <ItemsWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="8"/>
                                            </ItemsPanelTemplate>
                                        </GridView.ItemsPanel>
                                        
                                        <Border Background="#FF000000" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF000000"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFF0000" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFF0000"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFF7F00" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFF7F00"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFFFF00" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFFFF00"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF00FF00" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF00FF00"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF00FFFF" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF00FFFF"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF0000FF" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF0000FF"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF7F00FF" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF7F00FF"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFFFFFF" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFFFFFF"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="2"/>
                                        <Border Background="#FF808080" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF808080"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF8B0000" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF8B0000"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF006400" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF006400"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF00008B" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF00008B"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF8B4513" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF8B4513"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFF69B4" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFF69B4"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF87CEEB" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF87CEEB"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                    </GridView>
                                </StackPanel>
                                
                                <Border Height="1" 
                                        Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>
                                
                                <!-- Custom Color Picker -->
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Custom Color"
                                               Style="{StaticResource CaptionTextBlockStyle}"/>
                                    <ColorPicker Color="{x:Bind ViewModel.StrokeColor, Mode=TwoWay}"
                                                 ColorSpectrumShape="Ring"
                                                 IsAlphaEnabled="True"/>
                                </StackPanel>
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </Button>

                <!-- Fill Color with Presets -->
                <Button x:Name="FillColorButton"
                        Width="100"
                        ToolTipService.ToolTip="Fill Color">
                    <StackPanel Orientation="Horizontal" Spacing="4">
                        <Border Width="20"
                                Height="20"
                                Background="{x:Bind ViewModel.FillColor, Mode=OneWay, Converter={StaticResource ColorToBrushConverter}}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="2"/>
                        <TextBlock Text="Fill"
                                   VerticalAlignment="Center"
                                   Style="{StaticResource CaptionTextBlockStyle}"/>
                        <FontIcon Glyph="&#xE70D;" FontSize="10"/>
                    </StackPanel>
                    
                    <Button.Flyout>
                        <Flyout>
                            <StackPanel Spacing="12" Width="300">
                                <TextBlock Text="Fill Color"
                                           Style="{StaticResource BodyStrongTextBlockStyle}"/>
                                
                                <!-- No Fill Option -->
                                <Button Content="No Fill (Transparent)"
                                        Click="NoFill_Click"
                                        HorizontalAlignment="Stretch"/>
                                
                                <!-- Color Presets -->
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Quick Colors"
                                               Style="{StaticResource CaptionTextBlockStyle}"/>
                                    <GridView SelectionMode="None"
                                              IsItemClickEnabled="True"
                                              ItemClick="FillPresetColor_Click">
                                        <GridView.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <ItemsWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="8"/>
                                            </ItemsPanelTemplate>
                                        </GridView.ItemsPanel>
                                        
                                        <Border Background="#FF000000" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF000000"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFF0000" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFF0000"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFF7F00" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFF7F00"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFFFF00" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFFFF00"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF00FF00" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF00FF00"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF00FFFF" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF00FFFF"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF0000FF" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF0000FF"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF7F00FF" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF7F00FF"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFFFFFF" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFFFFFF"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="2"/>
                                        <Border Background="#FF808080" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF808080"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF8B0000" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF8B0000"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF006400" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF006400"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF00008B" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF00008B"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF8B4513" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF8B4513"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FFFF69B4" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FFFF69B4"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                        <Border Background="#FF87CEEB" Width="32" Height="32" 
                                                CornerRadius="4" Margin="2" Tag="#FF87CEEB"
                                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                BorderThickness="1"/>
                                    </GridView>
                                </StackPanel>
                                
                                <Border Height="1" 
                                        Background="{ThemeResource DividerStrokeColorDefaultBrush}"/>
                                
                                <!-- Custom Color Picker -->
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Custom Color"
                                               Style="{StaticResource CaptionTextBlockStyle}"/>
                                    <ColorPicker Color="{x:Bind ViewModel.FillColor, Mode=TwoWay}"
                                                 ColorSpectrumShape="Ring"
                                                 IsAlphaEnabled="True"/>
                                </StackPanel>
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </Button>
            </StackPanel>
            
            <!-- Settings Preview Panel -->
            <Border Grid.Column="4"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Padding="8"
                    Margin="12,0,0,0">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="Preview:"
                               VerticalAlignment="Center"
                               Style="{StaticResource CaptionTextBlockStyle}"/>
                    
                    <Canvas Width="60" Height="30">
                        <Rectangle Width="50" 
                                   Height="20"
                                   Canvas.Left="5"
                                   Canvas.Top="5"
                                   Stroke="{x:Bind ViewModel.StrokeColor, Mode=OneWay, Converter={StaticResource ColorToBrushConverter}}"
                                   StrokeThickness="{x:Bind ViewModel.StrokeThickness, Mode=OneWay}"
                                   StrokeDashArray="{x:Bind ViewModel.SelectedStrokeDashStyle, Mode=OneWay, Converter={StaticResource StrokeDashStyleToDoubleCollectionConverter}}"
                                   Fill="{x:Bind ViewModel.FillColor, Mode=OneWay, Converter={StaticResource ColorToBrushConverter}}"
                                   RadiusX="2"
                                   RadiusY="2"/>
                    </Canvas>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Drawing Canvas Area -->
        <ScrollViewer Grid.Row="1"
                      Grid.Column="0"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto"
                      ZoomMode="Enabled"
                      MinZoomFactor="0.25"
                      MaxZoomFactor="4"
                      Background="{ThemeResource LayerFillColorDefaultBrush}">

            <Grid HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  Margin="24">

                <!-- Canvas Container -->
                <Border BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="2"
                        CornerRadius="4">
                    <Canvas x:Name="DrawingCanvas"
                            Width="{x:Bind ViewModel.CanvasWidth, Mode=OneWay}"
                            Height="{x:Bind ViewModel.CanvasHeight, Mode=OneWay}"
                            Background="{x:Bind ViewModel.CanvasBackgroundColor, Mode=OneWay, Converter={StaticResource ColorToBrushConverter}}"
                            PointerPressed="DrawingCanvas_PointerPressed"
                            PointerMoved="DrawingCanvas_PointerMoved"
                            PointerReleased="DrawingCanvas_PointerReleased"/>
                </Border>

                <!-- Canvas Info Overlay -->
                <TextBlock VerticalAlignment="Bottom"
                           HorizontalAlignment="Left"
                           Margin="0,0,0,-24"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           Style="{StaticResource CaptionTextBlockStyle}">
                    <Run Text="{x:Bind ViewModel.CanvasWidth, Mode=OneWay}"/>
                    <Run Text="Ã—"/>
                    <Run Text="{x:Bind ViewModel.CanvasHeight, Mode=OneWay}"/>
                    <Run Text="px"/>
                </TextBlock>
            </Grid>
        </ScrollViewer>

        <!-- Properties Panel -->
        <controls:PropertiesPanel x:Name="ShapePropertiesPanel"
                                  Grid.Row="1"
                                  Grid.Column="1"
                                  Width="280"
                                  Visibility="{x:Bind ViewModel.HasSelection, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}"
                                  SelectedShape="{x:Bind ViewModel.SelectedShape, Mode=OneWay}"
                                  ShapeDeleted="PropertiesPanel_ShapeDeleted"
                                  ShapePropertyChanged="PropertiesPanel_ShapePropertyChanged"/>
    </Grid>
</Page>
